<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tableau de Bord Caissier</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #4f46e5;
      --primary-light: #6366f1;
      --primary-dark: #4338ca;
      --secondary: #f59e0b;
      --success: #10b981;
      --danger: #ef4444;
      --warning: #f59e0b;
      --info: #3b82f6;
      --light: #f8fafc;
      --dark: #1e293b;
      --gray: #64748b;
      --sidebar-width: 280px;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f1f5f9;
      color: var(--dark);
    }
    
    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      background: white;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
      z-index: 1000;
    }
    
    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .sidebar-menu {
      padding: 1rem 0;
    }
    
    .menu-title {
      padding: 0.5rem 1.5rem;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .menu-item {
      display: flex;
      align-items: center;
      padding: 0.75rem 1.5rem;
      color: var(--dark);
      text-decoration: none;
      transition: all 0.2s;
    }
    
    .menu-item:hover, .menu-item.active {
      background-color: #f1f5f9;
      color: var(--primary);
    }
    
    .menu-item i {
      width: 24px;
      margin-right: 12px;
      font-size: 1rem;
      text-align: center;
    }
    
    /* Main content */
    .main-content {
      margin-left: var(--sidebar-width);
      min-height: 100vh;
      transition: all 0.3s;
    }
    
    /* Navbar */
    .navbar {
      height: 70px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      background: white;
    }
    
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }
    
    /* Cards */
    .stat-card {
      border-radius: 12px;
      border: none;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: transform 0.3s;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
    }
    
    .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
    }
    
    /* Tables */
    .data-table {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    
    .badge {
      padding: 0.35em 0.65em;
      font-weight: 500;
    }
    
    /* Responsive */
    @media (max-width: 992px) {
      .sidebar {
        transform: translateX(-100%);
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .menu-toggle {
        display: block !important;
      }
    }
    
    /* Toggle button for mobile */
    .menu-toggle {
      display: none;
      background: var(--primary);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      font-size: 1.25rem;
    }
    
    /* Modal */
    .modal-content {
      border-radius: 12px;
      border: none;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    
    /* Payment status */
    .payment-status {
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.25rem 0.75rem;
      border-radius: 50px;
    }
    
    /* Search box */
    .search-box {
      position: relative;
    }
    
    .search-box input {
      padding-left: 40px;
    }
    
    .search-box i {
      position: absolute;
      left: 15px;
      top: 12px;
      color: var(--gray);
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h4 class="mb-0 text-primary">VoyagePlus</h4>
      <small class="text-muted">Tableau de bord Caissier</small>
    </div>
    
    <div class="sidebar-menu">
      <div class="menu-title">Navigation</div>
      <a href="#" class="menu-item active" data-section="dashboard">
        <i class="fas fa-tachometer-alt"></i>
        <span>Tableau de bord</span>
      </a>
      
      <div class="menu-title">Gestion des Paiements</div>
      <a href="#" class="menu-item" data-section="reservations">
        <i class="fas fa-ticket-alt"></i>
        <span>Réservations</span>
      </a>
      <a href="#" class="menu-item" data-section="payments">
        <i class="fas fa-credit-card"></i>
        <span>Paiements</span>
      </a>
      <a href="#" class="menu-item" data-section="process-payment">
        <i class="fas fa-cash-register"></i>
        <span>Traiter un paiement</span>
      </a>
      
      <div class="menu-title">Mon Compte</div>
      <a href="#" class="menu-item" data-section="profile">
        <i class="fas fa-user"></i>
        <span>Mon profil</span>
      </a>
      <a href="#" class="menu-item" data-section="password">
        <i class="fas fa-key"></i>
        <span>Changer mot de passe</span>
      </a>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Navbar -->
    <nav class="navbar navbar-expand navbar-light sticky-top">
      <div class="container-fluid">
        <button class="menu-toggle me-3" id="menuToggle">
          <i class="fas fa-bars"></i>
        </button>
        
        <div class="d-flex align-items-center ms-auto">
          <div class="dropdown">
            <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" id="dropdownUser" data-bs-toggle="dropdown" aria-expanded="false">
              <img src="https://ui-avatars.com/api/?name=Caissier&background=4f46e5&color=fff" alt="Caissier" class="user-avatar me-2">
              <span class="d-none d-md-inline">Caissier</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownUser">
              <li><a class="dropdown-item" href="#" data-section="profile"><i class="fas fa-user-cog me-2"></i> Mon profil</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item text-danger" href="#" id="logoutBtn"><i class="fas fa-sign-out-alt me-2"></i> Déconnexion</a></li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- Page Content -->
    <div class="container-fluid py-4">
      <!-- Dashboard Section (Default) -->
      <div class="section-content" id="dashboard-section">
        <h4 class="mb-4">Tableau de bord</h4>
        
        <div class="row g-4 mb-4">
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <h6 class="text-muted mb-2">Paiements aujourd'hui</h6>
                    <h3 class="mb-0">24</h3>
                    <small class="text-success"><i class="fas fa-arrow-up me-1"></i> 12%</small>
                  </div>
                  <div class="stat-icon bg-primary">
                    <i class="fas fa-coins"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <h6 class="text-muted mb-2">Montant aujourd'hui</h6>
                    <h3 class="mb-0">42,500 DA</h3>
                    <small class="text-success"><i class="fas fa-arrow-up me-1"></i> 8%</small>
                  </div>
                  <div class="stat-icon bg-success">
                    <i class="fas fa-money-bill-wave"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <h6 class="text-muted mb-2">Réservations impayées</h6>
                    <h3 class="mb-0">8</h3>
                    <small class="text-danger"><i class="fas fa-arrow-up me-1"></i> 2</small>
                  </div>
                  <div class="stat-icon bg-danger">
                    <i class="fas fa-exclamation-circle"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <h6 class="text-muted mb-2">Remboursements</h6>
                    <h3 class="mb-0">3</h3>
                    <small class="text-danger"><i class="fas fa-arrow-up me-1"></i> 1</small>
                  </div>
                  <div class="stat-icon bg-warning">
                    <i class="fas fa-exchange-alt"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="row g-4">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Paiements récents</h5>
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Réservation</th>
                        <th>Montant</th>
                        <th>Méthode</th>
                        <th>Statut</th>
                        <th>Date</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>PAY-789456</td>
                        <td>RES-789456</td>
                        <td>1,200 DA</td>
                        <td>Carte</td>
                        <td><span class="badge bg-success">Complété</span></td>
                        <td>10/06/2023 14:30</td>
                      </tr>
                      <tr>
                        <td>PAY-123456</td>
                        <td>RES-123456</td>
                        <td>1,500 DA</td>
                        <td>Espèces</td>
                        <td><span class="badge bg-success">Complété</span></td>
                        <td>10/06/2023 11:45</td>
                      </tr>
                      <tr>
                        <td>PAY-654321</td>
                        <td>RES-654321</td>
                        <td>1,800 DA</td>
                        <td>Virement</td>
                        <td><span class="badge bg-warning">En attente</span></td>
                        <td>10/06/2023 10:20</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-4">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Statut des paiements</h5>
                <canvas id="paymentChart" height="250"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Reservations Section -->
      <div class="section-content d-none" id="reservations-section">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h4>Gestion des Réservations</h4>
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" class="form-control" placeholder="Rechercher une réservation..." id="reservationSearch">
          </div>
        </div>
        
        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-hover" id="reservationsTable">
                <thead>
                  <tr>
                    <th>Référence</th>
                    <th>Client</th>
                    <th>Trajet</th>
                    <th>Date/Heure</th>
                    <th>Montant</th>
                    <th>Statut Paiement</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>RES-789456</td>
                    <td>Jean Dupont</td>
                    <td>Alger → Oran</td>
                    <td>15/06/2023 08:30</td>
                    <td>1,200 DA</td>
                    <td><span class="badge bg-success">Payé</span></td>
                    <td>
                      <button class="btn btn-sm btn-outline-primary me-1 view-reservation">
                        <i class="fas fa-eye"></i>
                      </button>
                      <button class="btn btn-sm btn-outline-info process-payment" disabled>
                        <i class="fas fa-credit-card"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>RES-123456</td>
                    <td>Marie Lambert</td>
                    <td>Oran → Constantine</td>
                    <td>12/06/2023 14:15</td>
                    <td>1,500 DA</td>
                    <td><span class="badge bg-success">Payé</span></td>
                    <td>
                      <button class="btn btn-sm btn-outline-primary me-1 view-reservation">
                        <i class="fas fa-eye"></i>
                      </button>
                      <button class="btn btn-sm btn-outline-info process-payment" disabled>
                        <i class="fas fa-credit-card"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>RES-654321</td>
                    <td>Pierre Martin</td>
                    <td>Alger → Annaba</td>
                    <td>20/06/2023 07:00</td>
                    <td>1,800 DA</td>
                    <td><span class="badge bg-danger">Non payé</span></td>
                    <td>
                      <button class="btn btn-sm btn-outline-primary me-1 view-reservation">
                        <i class="fas fa-eye"></i>
                      </button>
                      <button class="btn btn-sm btn-outline-info process-payment">
                        <i class="fas fa-credit-card"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Payments Section -->
      <div class="section-content d-none" id="payments-section">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h4>Historique des Paiements</h4>
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" class="form-control" placeholder="Rechercher un paiement..." id="paymentSearch">
          </div>
        </div>
        
        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-hover" id="paymentsTable">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Réservation</th>
                    <th>Client</th>
                    <th>Montant</th>
                    <th>Méthode</th>
                    <th>Statut</th>
                    <th>Date</th>
                    <th>Caissier</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>PAY-789456</td>
                    <td>RES-789456</td>
                    <td>Jean Dupont</td>
                    <td>1,200 DA</td>
                    <td>Carte de crédit</td>
                    <td><span class="badge bg-success">Complété</span></td>
                    <td>10/06/2023 14:30</td>
                    <td>Mohamed K.</td>
                  </tr>
                  <tr>
                    <td>PAY-123456</td>
                    <td>RES-123456</td>
                    <td>Marie Lambert</td>
                    <td>1,500 DA</td>
                    <td>Espèces</td>
                    <td><span class="badge bg-success">Complété</span></td>
                    <td>10/06/2023 11:45</td>
                    <td>Ali B.</td>
                  </tr>
                  <tr>
                    <td>PAY-654321</td>
                    <td>RES-654321</td>
                    <td>Pierre Martin</td>
                    <td>1,800 DA</td>
                    <td>Virement</td>
                    <td><span class="badge bg-warning">En attente</span></td>
                    <td>10/06/2023 10:20</td>
                    <td>Karim M.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Process Payment Section -->
      <div class="section-content d-none" id="process-payment-section">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h4>Traiter un Paiement</h4>
          <button class="btn btn-outline-secondary" data-section="payments">
            <i class="fas fa-arrow-left me-2"></i>Retour
          </button>
        </div>
        
        <div class="row">
          <div class="col-lg-8">
            <div class="card mb-4">
              <div class="card-body">
                <h5 class="card-title">Rechercher une réservation</h5>
                <form id="searchReservationForm">
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label class="form-label">Référence réservation</label>
                      <input type="text" class="form-control" id="reservationReference" placeholder="RES-123456">
                    </div>
                    <div class="col-md-6 mb-3">
                      <label class="form-label">Nom du client</label>
                      <input type="text" class="form-control" id="clientName" placeholder="Nom du client">
                    </div>
                  </div>
                  <button type="submit" class="btn btn-primary">
                    <i class="fas fa-search me-1"></i> Rechercher
                  </button>
                </form>
              </div>
            </div>
            
            <div class="card d-none" id="reservationDetailsCard">
              <div class="card-body">
                <h5 class="card-title">Détails de la réservation</h5>
                <div id="reservationDetailsContent">
                  <!-- Will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-4">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Paiement</h5>
                <form id="paymentForm">
                  <div class="mb-3">
                    <label class="form-label">Montant à payer</label>
                    <input type="text" class="form-control" id="paymentAmount" readonly>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Méthode de paiement</label>
                    <select class="form-select" id="paymentMethod" required>
                      <option value="">Sélectionner</option>
                      <option value="credit_card">Carte de crédit</option>
                      <option value="cash">Espèces</option>
                      <option value="bank_transfer">Virement bancaire</option>
                      <option value="check">Chèque</option>
                    </select>
                  </div>
                  <div id="creditCardFields" class="d-none">
                    <div class="mb-3">
                      <label class="form-label">Numéro de carte</label>
                      <input type="text" class="form-control" placeholder="1234 5678 9012 3456">
                    </div>
                    <div class="row">
                      <div class="col-md-6 mb-3">
                        <label class="form-label">Date d'expiration</label>
                        <input type="text" class="form-control" placeholder="MM/AA">
                      </div>
                      <div class="col-md-6 mb-3">
                        <label class="form-label">CVV</label>
                        <input type="text" class="form-control" placeholder="123">
                      </div>
                    </div>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Montant reçu</label>
                    <input type="number" class="form-control" id="amountReceived" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Monnaie rendue</label>
                    <input type="text" class="form-control" id="changeAmount" readonly>
                  </div>
                  <button type="submit" class="btn btn-primary w-100">
                    <i class="fas fa-check-circle me-1"></i> Confirmer le paiement
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Profile Section -->
      <div class="section-content d-none" id="profile-section">
        <h4 class="mb-4">Mon Profil</h4>
        
        <div class="row">
          <div class="col-lg-4">
            <div class="card">
              <div class="card-body text-center">
                <img src="https://ui-avatars.com/api/?name=Caissier&background=4f46e5&color=fff" alt="Caissier" class="rounded-circle mb-3" width="120">
                <h5>Caissier</h5>
                <p class="text-muted">Caissier Principal</p>
                
                <button class="btn btn-outline-primary btn-sm">
                  <i class="fas fa-camera me-1"></i> Changer photo
                </button>
              </div>
            </div>
          </div>
          
          <div class="col-lg-8">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Informations personnelles</h5>
                <form>
                  <div class="mb-3">
                    <label class="form-label">Nom complet</label>
                    <input type="text" class="form-control" value="Caissier">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" value="caissier@voyageplus.com">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Téléphone</label>
                    <input type="tel" class="form-control" value="+213 123 456 789">
                  </div>
                  <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save me-1"></i> Enregistrer
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Password Section -->
      <div class="section-content d-none" id="password-section">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-body">
                <h4 class="mb-4">Changer mon mot de passe</h4>
                
                <form>
                  <div class="mb-3">
                    <label class="form-label">Ancien mot de passe</label>
                    <input type="password" class="form-control">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Nouveau mot de passe</label>
                    <input type="password" class="form-control">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Confirmer mot de passe</label>
                    <input type="password" class="form-control">
                  </div>
                  <button type="submit" class="btn btn-primary">
                    <i class="fas fa-key me-1"></i> Mettre à jour
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Reservation Details Modal -->
  <div class="modal fade" id="reservationDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Détails de la réservation</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modalReservationDetails">
          <!-- Will be populated by JavaScript -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment Receipt Modal -->
  <div class="modal fade" id="paymentReceiptModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Reçu de paiement</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="paymentReceiptContent">
          <!-- Will be populated by JavaScript -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
          <button type="button" class="btn btn-primary" id="printReceiptBtn">
            <i class="fas fa-print me-1"></i> Imprimer
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Sample data
    const reservations = [
      {
        id: 'RES-789456',
        client: 'Jean Dupont',
        departure: 'Alger',
        arrival: 'Oran',
        date: '2023-06-15',
        time: '08:30',
        seat: 'A12',
        price: 1200,
        status: 'confirmed',
        paymentStatus: 'paid',
        vehicle: 'Bus 45 (AB-12345)',
        driver: 'Mohamed K.'
      },
      {
        id: 'RES-123456',
        client: 'Marie Lambert',
        departure: 'Oran',
        arrival: 'Constantine',
        date: '2023-06-12',
        time: '14:15',
        seat: 'B07',
        price: 1500,
        status: 'completed',
        paymentStatus: 'paid',
        vehicle: 'Bus 32 (OR-54321)',
        driver: 'Ali B.'
      },
      {
        id: 'RES-654321',
        client: 'Pierre Martin',
        departure: 'Alger',
        arrival: 'Annaba',
        date: '2023-06-20',
        time: '07:00',
        seat: 'C15',
        price: 1800,
        status: 'pending',
        paymentStatus: 'unpaid',
        vehicle: 'Bus 12 (AN-98765)',
        driver: 'Karim M.'
      }
    ];
    
    const payments = [
      {
        id: 'PAY-789456',
        reservationId: 'RES-789456',
        client: 'Jean Dupont',
        amount: 1200,
        method: 'credit_card',
        status: 'completed',
        date: '2023-06-10 14:30',
        cashier: 'Mohamed K.'
      },
      {
        id: 'PAY-123456',
        reservationId: 'RES-123456',
        client: 'Marie Lambert',
        amount: 1500,
        method: 'cash',
        status: 'completed',
        date: '2023-06-10 11:45',
        cashier: 'Ali B.'
      },
      {
        id: 'PAY-654321',
        reservationId: 'RES-654321',
        client: 'Pierre Martin',
        amount: 1800,
        method: 'bank_transfer',
        status: 'pending',
        date: '2023-06-10 10:20',
        cashier: 'Karim M.'
      }
    ];

    // Initialize the dashboard
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize chart
      initPaymentChart();
      
      // Set up event listeners
      setupEventListeners();
    });
    
    function initPaymentChart() {
      const ctx = document.getElementById('paymentChart').getContext('2d');
      const paymentChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Complétés', 'En attente', 'Échoués'],
          datasets: [{
            data: [65, 15, 20],
            backgroundColor: [
              '#10b981',
              '#f59e0b',
              '#ef4444'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
    }
    
    function setupEventListeners() {
      // Sidebar toggle for mobile
      document.getElementById('menuToggle').addEventListener('click', function() {
        document.querySelector('.sidebar').classList.toggle('active');
      });
      
      // Navigation between sections
      document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Remove active class from all menu items
          document.querySelectorAll('.menu-item').forEach(i => {
            i.classList.remove('active');
          });
          
          // Add active class to clicked item
          this.classList.add('active');
          
          // Hide all sections
          document.querySelectorAll('.section-content').forEach(section => {
            section.classList.add('d-none');
          });
          
          // Show the selected section
          const sectionId = this.getAttribute('data-section') + '-section';
          document.getElementById(sectionId).classList.remove('d-none');
          
          // Close sidebar on mobile
          if (window.innerWidth < 992) {
            document.querySelector('.sidebar').classList.remove('active');
          }
        });
      });

      // Handle profile link in dropdown
      document.querySelector('[data-section="profile"]').addEventListener('click', function(e) {
        e.preventDefault();
        
        // Remove active class from all menu items
        document.querySelectorAll('.menu-item').forEach(i => {
          i.classList.remove('active');
        });
        
        // Activate profile menu item
        document.querySelector('[data-section="profile"]').classList.add('active');
        
        // Hide all sections
        document.querySelectorAll('.section-content').forEach(section => {
          section.classList.add('d-none');
        });
        
        // Show profile section
        document.getElementById('profile-section').classList.remove('d-none');
        
        // Close dropdown
        const dropdown = bootstrap.Dropdown.getInstance(document.getElementById('dropdownUser'));
        dropdown.hide();
      });
      
      // Logout function
      document.getElementById('logoutBtn').addEventListener('click', function(e) {
        e.preventDefault();
        if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
          // Here you would typically make an AJAX call to logout
          window.location.href = '/logout'; // Change this to your logout route
        }
      });
      
      // View reservation details
      document.querySelectorAll('.view-reservation').forEach(btn => {
        btn.addEventListener('click', function() {
          const row = this.closest('tr');
          const reservationId = row.querySelector('td').textContent;
          showReservationDetails(reservationId);
        });
      });
      
      // Process payment from reservations table
      document.querySelectorAll('.process-payment:not(:disabled)').forEach(btn => {
        btn.addEventListener('click', function() {
          const row = this.closest('tr');
          const reservationId = row.querySelector('td').textContent;
          const reservation = reservations.find(r => r.id === reservationId);
          
          if (reservation) {
            // Navigate to process payment section
            document.querySelector('[data-section="process-payment"]').click();
            
            // Fill payment form
            document.getElementById('paymentAmount').value = `${reservation.price} DA`;
            
            // Show reservation details
            showReservationDetailsForPayment(reservation);
          }
        });
      });
      
      // Payment method change
      document.getElementById('paymentMethod').addEventListener('change', function() {
        const creditCardFields = document.getElementById('creditCardFields');
        if (this.value === 'credit_card') {
          creditCardFields.classList.remove('d-none');
        } else {
          creditCardFields.classList.add('d-none');
        }
      });
      
      // Calculate change
      document.getElementById('amountReceived').addEventListener('input', function() {
        const amountToPay = parseFloat(document.getElementById('paymentAmount').value) || 0;
        const amountReceived = parseFloat(this.value) || 0;
        const change = amountReceived - amountToPay;
        
        document.getElementById('changeAmount').value = change >= 0 ? `${change.toFixed(2)} DA` : 'Montant insuffisant';
      });
      
      // Payment form submission
      document.getElementById('paymentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const amountToPay = parseFloat(document.getElementById('paymentAmount').value) || 0;
        const amountReceived = parseFloat(document.getElementById('amountReceived').value) || 0;
        
        if (amountReceived < amountToPay) {
          alert('Le montant reçu est inférieur au montant à payer');
          return;
        }
        
        // Generate payment ID
        const paymentId = 'PAY-' + Math.floor(100000 + Math.random() * 900000);
        
        // Create payment receipt
        const paymentReceipt = {
          id: paymentId,
          date: new Date().toLocaleString(),
          amount: amountToPay,
          method: document.getElementById('paymentMethod').value,
          cashier: 'Caissier'
        };
        
        // Show payment receipt
        showPaymentReceipt(paymentReceipt);
        
        // In a real app, you would send this to the backend
        fetch('/api/payments', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(paymentReceipt)
        })
        .then(response => response.json())
        .then(data => {
          console.log('Payment processed:', data);
        })
        .catch(error => {
          console.error('Error:', error);
        });
      });
      
      // Search reservation form submission
      document.getElementById('searchReservationForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const reference = document.getElementById('reservationReference').value;
        const clientName = document.getElementById('clientName').value;
        
        // In a real app, you would search reservations from the backend
        const foundReservation = reservations.find(r => 
          r.id === reference || r.client.toLowerCase().includes(clientName.toLowerCase())
        );
        
        if (foundReservation) {
          showReservationDetailsForPayment(foundReservation);
          document.getElementById('paymentAmount').value = `${foundReservation.price} DA`;
        } else {
          alert('Aucune réservation trouvée');
        }
      });
      
      // Print receipt button
      document.getElementById('printReceiptBtn').addEventListener('click', function() {
        window.print();
      });
    }
    
    function showReservationDetails(reservationId) {
      const reservation = reservations.find(r => r.id === reservationId);
      if (!reservation) return;
      
      const modalContent = document.getElementById('modalReservationDetails');
      
      const dateObj = new Date(reservation.date);
      const formattedDate = `${dateObj.getDate().toString().padStart(2, '0')}/${(dateObj.getMonth() + 1).toString().padStart(2, '0')}/${dateObj.getFullYear()}`;
      
      const paymentStatus = reservation.paymentStatus === 'paid' ? 
        '<span class="badge bg-success">Payé</span>' : 
        '<span class="badge bg-danger">Non payé</span>';
      
      modalContent.innerHTML = `
        <div class="row">
          <div class="col-md-6">
            <h5>Détails du client</h5>
            <div class="mb-3">
              <strong>Nom:</strong> ${reservation.client}
            </div>
            <div class="mb-3">
              <strong>Référence:</strong> ${reservation.id}
            </div>
            <div class="mb-3">
              <strong>Statut paiement:</strong> ${paymentStatus}
            </div>
          </div>
          <div class="col-md-6">
            <h5>Détails du trajet</h5>
            <div class="mb-3">
              <strong>Trajet:</strong> ${reservation.departure} → ${reservation.arrival}
            </div>
            <div class="mb-3">
              <strong>Date:</strong> ${formattedDate} à ${reservation.time}
            </div>
            <div class="mb-3">
              <strong>Siège:</strong> ${reservation.seat}
            </div>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6">
            <h5>Informations véhicule</h5>
            <div class="mb-3">
              <strong>Véhicule:</strong> ${reservation.vehicle}
            </div>
            <div class="mb-3">
              <strong>Chauffeur:</strong> ${reservation.driver}
            </div>
          </div>
          <div class="col-md-6">
            <h5>Informations financières</h5>
            <div class="mb-3">
              <strong>Prix:</strong> ${reservation.price} DA
            </div>
            <div class="mb-3">
              <strong>Statut:</strong> ${reservation.status === 'confirmed' ? 'Confirmé' : 
                                       reservation.status === 'pending' ? 'En attente' : 
                                       reservation.status === 'completed' ? 'Complété' : 'Inconnu'}
            </div>
          </div>
        </div>
      `;
      
      const modal = new bootstrap.Modal(document.getElementById('reservationDetailsModal'));
      modal.show();
    }
    
    function showReservationDetailsForPayment(reservation) {
      const reservationDetailsCard = document.getElementById('reservationDetailsCard');
      const reservationDetailsContent = document.getElementById('reservationDetailsContent');
      
      const dateObj = new Date(reservation.date);
      const formattedDate = `${dateObj.getDate().toString().padStart(2, '0')}/${(dateObj.getMonth() + 1).toString().padStart(2, '0')}/${dateObj.getFullYear()}`;
      
      reservationDetailsContent.innerHTML = `
        <div class="mb-3">
          <strong>Référence:</strong> ${reservation.id}
        </div>
        <div class="mb-3">
          <strong>Client:</strong> ${reservation.client}
        </div>
        <div class="mb-3">
          <strong>Trajet:</strong> ${reservation.departure} → ${reservation.arrival}
        </div>
        <div class="mb-3">
          <strong>Date:</strong> ${formattedDate} à ${reservation.time}
        </div>
        <div class="mb-3">
          <strong>Siège:</strong> ${reservation.seat}
        </div>
        <div class="mb-3">
          <strong>Prix:</strong> ${reservation.price} DA
        </div>
      `;
      
      reservationDetailsCard.classList.remove('d-none');
    }
    
    function showPaymentReceipt(payment) {
      const paymentReceiptContent = document.getElementById('paymentReceiptContent');
      
      paymentReceiptContent.innerHTML = `
        <div class="text-center mb-4">
          <h4>VoyagePlus</h4>
          <p class="text-muted">Reçu de paiement</p>
        </div>
        
        <div class="d-flex justify-content-between mb-2">
          <span class="text-muted">Numéro de reçu:</span>
          <span>${payment.id}</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span class="text-muted">Date:</span>
          <span>${payment.date}</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span class="text-muted">Caissier:</span>
          <span>${payment.cashier}</span>
        </div>
        
        <hr>
        
        <div class="d-flex justify-content-between mb-2">
          <span class="text-muted">Montant:</span>
          <span>${payment.amount} DA</span>
        </div>
        <div class="d-flex justify-content-between mb-3">
          <span class="text-muted">Méthode de paiement:</span>
          <span>${payment.method === 'credit_card' ? 'Carte de crédit' : 
                 payment.method === 'cash' ? 'Espèces' : 
                 payment.method === 'bank_transfer' ? 'Virement bancaire' : 
                 payment.method === 'check' ? 'Chèque' : 'Autre'}</span>
        </div>
        
        <hr>
        
        <div class="text-center mt-4">
          <p class="text-muted">Merci pour votre confiance!</p>
        </div>
      `;
      
      const modal = new bootstrap.Modal(document.getElementById('paymentReceiptModal'));
      modal.show();
    }
  </script>
</body>
</html>